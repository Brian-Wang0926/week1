<!DOCTYPE html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>登入成功</title>
    <link rel="stylesheet" href="../static/main.css">
    <script src="../static/scripts.js"></script>
</head>
<body>
    <div class="welcome">歡迎光臨，這是會員頁</div><br>
    <h1>{{ name }}，成功登入系統</h1>
    <a href="/signout">登出系統</a>
    <br><br>
    <hr/>
    <!-- 查詢會員 -->
    <h1>查詢會員姓名</h1>
    <form action="/api/member" method="GET" class="form">
        <input type="text" name="username" />
        <button type="button" id="memberButton" onclick="getMember()">查詢</button>
    </form>
    <p><span id="memberInfo"> </span></p>

    <!-- 修改名字 -->
    <h1>更新我的姓名</h1>
    <form action="/api/member" method="PATCH" class="form">
        <input type="text" name="newName" />
        <button type="button" id="renameButton" onclick="rename()">更新</button>
    </form>
    <p><span id="renameInfo"> </span></p>
    <hr/>

    <!-- 留言板 -->
    <h1>快來留言吧</h1>
    <form action="/createMessage" method="POST" class="form">
        內容 <input type="text" name="message" /><br>
        <button type="submit" id="messageButton">送出</button>
    </form>
    <br/>
    <hr/>
    <br/>
    
    {% for message in messages %}
        {% set sender = message['name'] %}
        {% set content = message['content'] %}
        {% set message_id = message['id'] %}
        {% if name == sender %}
            <form action="/deleteMessage" method="POST" class="form">
                <div class="container">
                    <nobr>{{ sender }}: {{ content }}</nobr>
                    <input type="hidden" name="message_id" value="{{ message_id }}">
                    <button type="button" id="deleteMessageButton" class="deleteMessageButton" onclick="confirmDelete(this.form,'{{ message_id }}')">X</button>
                </div>
            </form>
        {% else %}
            <p class="message">{{ sender }}: {{ content }}</p>
        {% endif %}
    {% endfor %}
</body>
</html>